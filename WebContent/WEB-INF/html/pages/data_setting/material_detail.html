<script type="text/javascript">
$(function(){
	
	if('${openMode!}' == 'edit'){
		var actionUrl = "o_material_update.do";
		$("form").attr("action", actionUrl);
	}
	
});
</script>
<div class="pageContent">
	<form method="post" action="o_material_save.do" class="pageForm required-validate" onsubmit="return validateCallback(this, navTabAjaxDone);">
		
		<input type="hidden" name="pageNum" value="${pageNum!}" />
		<input type="hidden" name="numPerPage" value="${numPerPage!}" />
		<input type="hidden" name="parentId" value="${parentId!}" />
		<input type="hidden" name="searchName" value="${searchName!}"/>
		
		<div class="pageFormContent" layoutH="56">
			<p>
				<label>ID:</label>
				<input name="id" type="text" size="20" value="${material.id!}" readonly="readonly"/>
			</p>
			
			<p>
				<label><@s.m "material.customerSerial" />:</label>
				<input name="customerSerial" type="text" size="20" value="${material.customerSerial!}"/>
			</p>
			<p>
				<label><@s.m "material.serial" />:</label>
				<input name="serial" type="text" size="20" value="${material.serial!}"/>
			</p>
			<p>
				<label><@s.m "material.name"/>:</label>
				<input name="name" type="text" size="20" value="${material.name!}"/>
			</p>
			<p>
			<!-- lookup的命名：input的name必须是完整的名字，比如lookupGroup.XXX，而后台返回的名字只需要XXX就可以，它会根据lookupGroup补全名字 -->
				<label><@s.m "category.1.parent"/>:</label>
				<input type="hidden" name="parent.id" value="${(material.parent.id)!}"/>
				<input type="text" class="required" name="parent.name" value="${(material.parent.name)!}" readonly/>
				<a class="btnLook" href="v_category_tree.do?parentId=1" lookupGroup="parent"><@s.m "category.1.parent"/></a>		
			</p>
			<p>
				<label><@s.m "company"/>:</label>
				<input type="hidden" name="company.id" value="${(material.company.id)!}"/>
				<input type="text" name="company.name" value="${(material.company.name)!}" readonly/>
				<a class="btnLook" href="v_company.do?type=1" lookupGroup="company"><@s.m "company"/></a>		
			</p>
			<p>
				<label><@s.m "material.spec"/>:</label>
				<input type="text" name="spec" value="${material.spec!}" class="textInput">
			</p>
			<p>
				<label><@s.m "material.dim"/>:</label>
				<input name="dim" type="text" value="${material.dim!}" size="20"/>
			</p>
			<p>
				<label><@s.m "material.unit"/>:</label>
				<input class="required" name="unit" type="text" value="${material.unit!}" suggestFields="unit" suggestUrl="v_material_unit.do"/>
			</p>
			<p>
				<label><@s.m "step.surface"/>:</label>
				<input type="hidden" name="surface.id" value="${(material.surface.id)!}"></input>
				<input type="text" name="surface.name" value="${(material.surface.name)!}" size="20" class="textInput" readonly>
				<a class="btnLook" href="v_step_list.do?type=2" lookupgroup="surface" lookuppk="id" title="<@s.m 'step.surface'/>"><@s.m 'step.surface'/></a>
			</p>
			<!-- 一定要加float:left，要不然会放在最前的位置 -->
			<div id="zyupload" class="zyupload" style="position:relative; display:block; float:left;"></div>   
		</div>
		<div class="formBar">
			<ul>
				<@berp_perm url="/v_material_add.do"><li><div class="buttonActive"><div class="buttonContent"><button type="submit">保存</button></div></div></li></@berp_perm>
				<li><div class="button"><div class="buttonContent"><a href="v_material.do?type=0&searchName=${searchName!}&parentId=${parentId!}&pageNum=${pageNum!}&numPerPage=${numPerPage!}" target="navTab" rel="main"><button type="button">取消</button></a></div></div></li>
			</ul>
		</div>
	</form>
    <script type="text/javascript">
		$(function(){
			// 初始化插件
			$("#zyupload").zyUpload({
				width            :   "650px",                 // 宽度
				height           :   "400px",                 // 宽度
				itemWidth        :   "140px",                 // 文件项的宽度
				itemHeight       :   "115px",                 // 文件项的高度
				url              :   "upload.do",  // 上传文件的路径
				fileType         :   ["jpg","png","js","exe"],// 上传文件的类型
				fileSize         :   51200000,                // 上传文件的大小
				multiple         :   true,                    // 是否可以多个文件上传
				dragDrop         :   true,                    // 是否可以拖动上传文件
				tailor           :   true,                    // 是否可以裁剪图片
				del              :   true,                    // 是否可以删除文件
				finishDel        :   false,  				  // 是否在上传文件完成后删除预览
				// 用户自定义附带值
		        customData       :   {'type':'张三','myTitle':'111','types':'3','content':'content','ncontent':'ncontent'},
				/* 外部获得的回调接口 */
				onSelect: function(selectFiles, allFiles){    // 选择文件的回调方法  selectFile:当前选中的文件  allFiles:还没上传的全部文件
					console.info("当前选择了以下文件：");
					console.info(selectFiles);
				},
				onDelete: function(file, files){              // 删除一个文件的回调方法 file:当前删除的文件  files:删除之后的文件
					console.info("当前删除了此文件：");
					console.info(file.name);
				},
				onSuccess: function(file, response){          // 文件上传成功的回调方法
					console.info("此文件上传成功：");
					console.info(file.name);
					console.info("此文件上传到服务器地址：");
					console.info(response);
					$("#uploadInf").append("<p>上传成功，文件地址是：" + response + "</p>");
				},
				onFailure: function(file, response){          // 文件上传失败的回调方法
					console.info("此文件上传失败：");
					console.info(file.name);
				},
				onComplete: function(response){           	  // 上传完成的回调方法
					console.info("文件上传完成");
					console.info(response);
				}
			});
			
		});
	
	</script> 
</div>
